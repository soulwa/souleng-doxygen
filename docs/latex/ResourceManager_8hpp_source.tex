\doxysection{Resource\+Manager.\+hpp}
\hypertarget{ResourceManager_8hpp_source}{}\label{ResourceManager_8hpp_source}\index{include/ResourceManager.hpp@{include/ResourceManager.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <SDL3/SDL.h>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <SDL3/SDL\_log.h>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <SDL3\_image/SDL\_image.h>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <SDL3\_ttf/SDL\_ttf.h>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ "{}Renderer.hpp"{}}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00015\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structDeleteTextureFunctor}{DeleteTextureFunctor}}\ \{}
\DoxyCodeLine{00016\ \ \ \textcolor{keywordtype}{void}\ operator()(SDL\_Texture\ *texture)\textcolor{keyword}{\ const\ }\{\ SDL\_DestroyTexture(texture);\ \}}
\DoxyCodeLine{00017\ \};}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structDeleteFontFunctor}{DeleteFontFunctor}}\ \{}
\DoxyCodeLine{00021\ \ \ \textcolor{keywordtype}{void}\ operator()(TTF\_Font\ *font)\textcolor{keyword}{\ const\ }\{\ TTF\_CloseFont(font);\ \}}
\DoxyCodeLine{00022\ \};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{inline}\ std::shared\_ptr<SDL\_Texture>\ make\_shared\_texture(SDL\_Surface\ *pixels)\ \{}
\DoxyCodeLine{00027\ \ \ \textcolor{keyword}{auto}\ renderer\ =\ \mbox{\hyperlink{structRenderer_a8f861daf0fb11238b50b66ab38e6a856}{Renderer::instance}}();}
\DoxyCodeLine{00028\ \ \ SDL\_Texture\ *texture\ =\ renderer-\/>CreateTextureFromSurface(pixels);}
\DoxyCodeLine{00029\ \ \ \textcolor{keywordflow}{if}\ (texture\ ==\ NULL)\ \{}
\DoxyCodeLine{00030\ \ \ \ \ SDL\_Log(\textcolor{stringliteral}{"{}Could\ not\ load\ texture\ from\ surface!"{}});}
\DoxyCodeLine{00031\ \ \ \}}
\DoxyCodeLine{00032\ \ \ \textcolor{keywordflow}{return}\ std::shared\_ptr<SDL\_Texture>(texture,\ \mbox{\hyperlink{structDeleteTextureFunctor}{DeleteTextureFunctor}}());}
\DoxyCodeLine{00033\ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structResourceManager}{ResourceManager}}\ \{}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structResourceManager}{ResourceManager}}\ \&\mbox{\hyperlink{structResourceManager_a6f1fdbd3b6cb40daa4f5a70f1f8c26b5}{instance}}()\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordflow}{if}\ (mInstance\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ mInstance\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{structResourceManager}{ResourceManager}};}
\DoxyCodeLine{00042\ \ \ \ \ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordflow}{return}\ *mInstance;}
\DoxyCodeLine{00045\ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00050\ \ \ std::shared\_ptr<SDL\_Texture>\ \mbox{\hyperlink{structResourceManager_a93e16d82f9002baaccc6a16e93d82237}{LoadTexture}}(std::string\ filepath)\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ c++20\ -\/>\ has\ contains\ method.\ otherwise,\ use\ find,\ cmp\ with\ map.end()}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{if}\ (!mTextureResources.contains(filepath))\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ SDL\_Surface\ *surface\ =\ IMG\_Load(filepath.c\_str());}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (surface\ ==\ NULL)\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ SDL\_LogError(}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ SDL\_LOG\_CATEGORY\_APPLICATION,}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Failed\ to\ load\ texture\ at\ path:\ \%s.\ Maybe\ the\ path\ is\ wrong?"{}},}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ filepath.c\_str());}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ SDL\_SetSurfaceColorKey(surface,\ SDL\_TRUE,}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SDL\_MapRGB(surface-\/>format,\ 255,\ 0,\ 255));}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ texture\ =\ make\_shared\_texture(surface);}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \textcolor{comment}{//\ c++20\ idiom,\ does\ insertion\ in\ one\ step\ vs\ index\ assignment.}}
\DoxyCodeLine{00066\ \ \ \ \ \ \ mTextureResources.insert(\{filepath,\ texture\});}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ SDL\_DestroySurface(surface);}
\DoxyCodeLine{00069\ \ \ \ \ \ \ SDL\_Log(\textcolor{stringliteral}{"{}Created\ new\ resource:\ \%s"{}},\ filepath.c\_str());}
\DoxyCodeLine{00070\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ SDL\_Log(\textcolor{stringliteral}{"{}Reused\ resource:\ \%s"{}},\ filepath.c\_str());}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{return}\ mTextureResources[filepath];}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00080\ \ \ std::shared\_ptr<TTF\_Font>\ \mbox{\hyperlink{structResourceManager_aa7a205376e18efdac911510de624083d}{LoadFont}}(std::string\ filepath,\ \textcolor{keywordtype}{int}\ ptsize)\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{if}\ (!mFontResources.contains(filepath)\ ||}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ !mFontResources[filepath].contains(ptsize))\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ TTF\_Font\ *font\ =\ TTF\_OpenFont(filepath.c\_str(),\ ptsize);}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (font\ ==\ NULL)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ SDL\_LogError(}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ SDL\_LOG\_CATEGORY\_APPLICATION,}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Failed\ to\ load\ font\ at\ path:\ \%s.\ Maybe\ the\ path\ is\ wrong?"{}},}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ filepath.c\_str());}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ SDL\_Log(\textcolor{stringliteral}{"{}Successfully\ loaded\ font\ at\ path:\ \%s."{}},\ filepath.c\_str());}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ mFontResources[filepath][ptsize]\ =}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ std::shared\_ptr<TTF\_Font>(font,\ \mbox{\hyperlink{structDeleteFontFunctor}{DeleteFontFunctor}}());}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{return}\ mFontResources[filepath][ptsize];}
\DoxyCodeLine{00098\ \ \ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{structResourceManager}{ResourceManager}}()\ \{\}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{structResourceManager}{ResourceManager}}\ *mInstance;}
\DoxyCodeLine{00104\ \ \ std::unordered\_map<std::string,\ std::shared\_ptr<SDL\_Texture>>}
\DoxyCodeLine{00105\ \ \ \ \ \ \ mTextureResources;}
\DoxyCodeLine{00106\ \ \ std::unordered\_map<std::string,}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unordered\_map<int,\ std::shared\_ptr<TTF\_Font>>>}
\DoxyCodeLine{00108\ \ \ \ \ \ \ mFontResources;}
\DoxyCodeLine{00109\ \};}

\end{DoxyCode}
